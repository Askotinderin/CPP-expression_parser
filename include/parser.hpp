#pragma once


#include "lexer.hpp"


const std::array<std::array<char, OP_SIZE>, OP_SIZE> operator_precedence = {{
//      EOE,    id      +       *       -       /       %       (       )       ^       &       |       =       ;       // row is token in expression (right)
    {   'a',    '<',    '<',    '<',    '<',    '<',    '<',    '<',    'x',    '<',    '<',    '<',    'x',    'p' },  // EOE
    {   '>',    'x',    '>',    '>',    '>',    '>',    '>',    'x',    '>',    '>',    '>',    '>',    '<',    'p' },  // id
    {   '>',    '<',    '>',    '<',    '>',    '<',    '<',    '<',    '>',    '<',    '>',    '>',    'x',    'p' },  // +
    {   '>',    '<',    '>',    '>',    '>',    '>',    '>',    '<',    '>',    '<',    '>',    '>',    'x',    'p' },  // *
    {   '>',    '<',    '>',    '<',    '>',    '<',    '<',    '<',    '>',    '<',    '>',    '>',    'x',    'p' },  // -
    {   '>',    '<',    '>',    '>',    '>',    '>',    '>',    '<',    '>',    '<',    '>',    '>',    'x',    'p' },  // /
    {   '>',    '<',    '>',    '>',    '>',    '>',    '>',    '<',    '>',    '<',    '>',    '>',    'x',    'p' },  // %
    {   'x',    '<',    '<',    '<',    '<',    '<',    '<',    '<',    '=',    '<',    '<',    '<',    'x',    'p' },  // (
    {   '>',    'x',    '>',    '>',    '>',    '>',    '>',    'x',    '>',    '>',    '>',    '>',    'x',    'p' },  // )
    {   '>',    '<',    '>',    '>',    '>',    '>',    '>',    '<',    '>',    '<',    '>',    '>',    'x',    'p' },  // ^
    {   '>',    '<',    '<',    '<',    '<',    '<',    '<',    '<',    '>',    '<',    '>',    '<',    'x',    'p' },  // &
    {   '>',    '<',    '<',    '<',    '<',    '<',    '<',    '<',    '>',    '<',    '<',    '>',    'x',    'p' },  // |
    {   's',    '<',    '<',    '<',    '<',    '<',    '<',    '<',    'x',    '<',    '<',    '<',    'x',    'p' },  // =
    {   'x',    'x',    'x',    'x',    'x',    'x',    'x',    'x',    'x',    'x',    'x',    'x',    'x',    'x' },  // ;
}};                                                                                                                     // collumn is token in stack (left)


class Parser {
private:
    std::stack<Token> t_stack;
    std::stack<float> f_stack;
    bool print;
    std::string last_var;

public:
    Parser ();
    void operator() (std::queue<Token>& tokens);
};